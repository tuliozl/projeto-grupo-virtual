<div class="page-header">
    <h1>
        Empresas

        <button class="btn btn-lg btn-success" (click)="exportData()" style="margin-left: 5%" *ngIf="!printView">
            <i class="icon-cloud-download"></i>
            Exportar planilha
        </button>

        <button class="btn btn-link" *ngIf="printView" (click)="exitPrintView()">Voltar</button>
    </h1>
    
</div>

<div class="row" *ngIf="!printView">
    <div class="col-xs-12">
        <div class="widget-box">
            <div class="widget-header">
                <h4>Cadastrar nova Empresa</h4>
            </div>

            <div class="widget-body">
                <div class="widget-main">
                    <div class="row">
                        <div class="col-xs-3">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-1"> Nome </label>
                            <input type="text" id="form-field-1" placeholder="Nome" class="col-xs-10 col-sm-5" [(ngModel)]="name">
                            <input type="hidden" id="form-field-1" [(ngModel)]="id">
                        </div>

                        <div class="col-xs-3">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-2"> CNPJ </label>
                            <input type="text" id="form-field-2" placeholder="CNPJ" (blur)="checkCnpj()" class="col-xs-10 col-sm-5" [(ngModel)]="cnpj">
                        </div>

                        <div class="col-xs-3">
                            <label class="col-sm-3 control-label no-padding-right" for="form-field-3"> Imagem </label>
                            <input type="file" class="file-input" (change)="onFileSelected($event)" #fileUpload>
                        </div>
                        <div class="col-xs-3">
                            <button class="btn btn-app btn-grey btn-xs radius-4"  (click)="savecompany()">
                                <i class="icon-save bigger-160"></i>

                                Salvar
                            </button>

                            <button class="btn btn-app btn-light btn-xs radius-4" ng-if="id != ''"  (click)="reset()">
                                <i class="icon-ban-circle bigger-160"></i>

                                Cancelar
                            </button>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="col-xs-12">
        <div class="table-responsive">
            <table id="sample-table-1" class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        
                        <th>Nome</th>
                        <th>CNPJ</th>
                        <th>Logo</th>
                        <th>Criado em</th>
                        <th></th>
                    </tr>
                </thead>

                <tbody>

                    <tr *ngFor="let company of companies | async">
                        <td>
                            {{company.name}}
                        </td>
                        <td>
                            {{company.cnpj}}
                        </td>

                        <td>
                            <img src="http://localhost:8080/{{company.image}}" width="150"/>
                        </td>
                        
                        <td>
                            {{company.created_at  | date:"dd/mm/yyyy 'às' HH:mm"}}
                        </td>
                        <td>
                            <div class="visible-md visible-lg hidden-sm hidden-xs btn-group">
                                <button class="btn btn-xs btn-info" (click)="editCompany(company.id)" title="Editar">
                                    <i class="icon-edit bigger-120"></i>
                                </button>

                                <button class="btn btn-xs btn-info" (click)="viewCompany(company)" title="Visualizar para impressão">
                                    <i class="icon-eye-open bigger-120"></i>
                                </button>

                                <button class="btn btn-xs btn-danger" title="Remover" (click)="removeCompany(company.id)">
                                    <i class="icon-trash bigger-120"></i>
                                </button>
                            </div> 
                           
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="row" *ngIf="printView">
    <div class="widget-box">
        <div class="widget-header">
            <h4>{{name}}</h4>
        </div>

        <div class="widget-body">
            <div class="widget-main">
                <div class="row">
                    <div class="col-xs-6">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1"> CNPJ </label>
                        {{cnpj}}
                    </div>

                    <div class="col-xs-6">
                        <label class="col-sm-3 control-label no-padding-right" for="form-field-2"> Criado em </label>
                        {{created_at  | date:"dd/mm/yyyy 'às' HH:mm"}}
                    </div>

                    <div class="col-xs-12">
                        <img src="http://localhost:8080/{{image}}" width="10%"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
